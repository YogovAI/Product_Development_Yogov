stages:
  - build
  - test
  - deploy

variables:
  POSTGRES_DB: odoo18_db
  POSTGRES_USER: odoo18
  POSTGRES_PASSWORD: odoo18
  POSTGRES_HOST_AUTH_METHOD: trust

build-backend:
  stage: build
  image: python:3.10
  script:
    - cd backend
    - pip install -r requirements.txt
    - echo "Backend built successfully"

build-frontend:
  stage: build
  image: node:18
  script:
    - cd frontend
    - npm install
    - npm run build
    - echo "Frontend built successfully"

test-backend:
  stage: test
  image: python:3.10
  services:
    - postgres:14
  script:
    - cd backend
    - pip install -r requirements.txt
    - pytest

test-frontend:
  stage: test
  image: node:18
  script:
    - cd frontend
    - npm install
    - npm test
